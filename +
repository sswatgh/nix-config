{ pkgs, platform, ... }: 
let
  importModules = dir:
    if builtins.pathExists dir then
      let
        entries = builtins.readDir dir;
        nixFiles = builtins.attrNames (builtins.filter (name: type: 
          type == "regular" && builtins.match ".*\\.nix" name != null
        ) entries);
        subdirs = builtins.attrNames (builtins.filter (name: type: 
          type == "directory"
        ) entries);
        currentImports = map (f: dir + "/${f}") nixFiles;
        subdirImports = builtins.concatLists (map (subdir: 
          importModules (dir + "/${subdir}")
        ) subdirs);
      in
        currentImports ++ subdirImports
    else [];
in
{
  home.username = "ssw";
  home.homeDirectory = if platform.isDarwin then "/Users/ssw" else "/home/ssw";
  home.stateVersion = "23.11";

  imports = (importModules ./modules/cli);

  home.packages = with pkgs; [
    wget
    curl
    htop
  ];
}
